"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const file_system_1 = require("file_system");
const input_1 = require("./phases/input");
const plugin_phase_1 = require("./phases/plugin_phase");
const config_resolver_1 = require("config_resolver");
class Compiler {
    async compile(selectedProjects, allProjects, context, args) {
        let compileModel = {
            projectsBuildData: selectedProjects.map((p) => {
                const mlfs = new file_system_1.FileSystemMutationLogger(new file_system_1.MemoryFileSystem());
                const fs = new file_system_1.CachedFileSystem(context.fileSystem, mlfs);
                const bundle = config_resolver_1.getBundle(p.resolvedConfig, args.map);
                if (!bundle) {
                    throw new Error(`No bundle could be determined for project ${p} please define a default or state the bundle to be used with a CLI flag`);
                }
                return {
                    flags: args.map,
                    bundle,
                    allProjects,
                    selectedProjects,
                    project: p,
                    input: [],
                    get output() {
                        return Array.from(mlfs.writtenFiles);
                    },
                    fileSystem: fs
                };
            })
        };
        compileModel = await plugin_phase_1.pluginBasedPhase('init', compileModel, context);
        compileModel = await input_1.inputPhase(compileModel, context);
        compileModel = await plugin_phase_1.pluginBasedPhase('link', compileModel, context);
        this.sortByDependencies(compileModel, selectedProjects);
        compileModel = await plugin_phase_1.pluginBasedPhase('preProcess', compileModel, context);
        compileModel = await plugin_phase_1.pluginBasedChainedPhase(['compile', 'postProcess', { name: 'emit', defaultPlugins: ['output'] }], compileModel, context);
    }
    sortByDependencies(compileModel, selectedProjects) {
        const order = [];
        while (compileModel.projectsBuildData.length > 0) {
            let circle = true;
            for (let i = compileModel.projectsBuildData.length - 1; i >= 0; i--) {
                if (this.hasAll(compileModel.projectsBuildData[i].project.projectDependencies, selectedProjects, order)) {
                    order.push(compileModel.projectsBuildData[i]);
                    compileModel.projectsBuildData.splice(i, 1);
                    circle = false;
                }
            }
            if (circle) {
                throw new Error('Circular dependency in project dependencies');
            }
        }
        compileModel.projectsBuildData = order;
    }
    hasAll(projectDependencies, selectedProjects, order) {
        for (const p of projectDependencies) {
            if (!selectedProjects.includes(p)) {
                continue;
            }
            let has = false;
            for (const o of order) {
                if (o.project === p) {
                    has = true;
                    break;
                }
            }
            if (!has) {
                return false;
            }
        }
        return true;
    }
}
exports.Compiler = Compiler;
exports.compiler = new Compiler();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBpbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImNvbXBpbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgZmlsZV9zeXN0ZW1fMSA9IHJlcXVpcmUoXCJmaWxlX3N5c3RlbVwiKTtcbmNvbnN0IGlucHV0XzEgPSByZXF1aXJlKFwiLi9waGFzZXMvaW5wdXRcIik7XG5jb25zdCBwbHVnaW5fcGhhc2VfMSA9IHJlcXVpcmUoXCIuL3BoYXNlcy9wbHVnaW5fcGhhc2VcIik7XG5jb25zdCBjb25maWdfcmVzb2x2ZXJfMSA9IHJlcXVpcmUoXCJjb25maWdfcmVzb2x2ZXJcIik7XG5jbGFzcyBDb21waWxlciB7XG4gICAgYXN5bmMgY29tcGlsZShzZWxlY3RlZFByb2plY3RzLCBhbGxQcm9qZWN0cywgY29udGV4dCwgYXJncykge1xuICAgICAgICBsZXQgY29tcGlsZU1vZGVsID0ge1xuICAgICAgICAgICAgcHJvamVjdHNCdWlsZERhdGE6IHNlbGVjdGVkUHJvamVjdHMubWFwKChwKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWxmcyA9IG5ldyBmaWxlX3N5c3RlbV8xLkZpbGVTeXN0ZW1NdXRhdGlvbkxvZ2dlcihuZXcgZmlsZV9zeXN0ZW1fMS5NZW1vcnlGaWxlU3lzdGVtKCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZzID0gbmV3IGZpbGVfc3lzdGVtXzEuQ2FjaGVkRmlsZVN5c3RlbShjb250ZXh0LmZpbGVTeXN0ZW0sIG1sZnMpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJ1bmRsZSA9IGNvbmZpZ19yZXNvbHZlcl8xLmdldEJ1bmRsZShwLnJlc29sdmVkQ29uZmlnLCBhcmdzLm1hcCk7XG4gICAgICAgICAgICAgICAgaWYgKCFidW5kbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBidW5kbGUgY291bGQgYmUgZGV0ZXJtaW5lZCBmb3IgcHJvamVjdCAke3B9IHBsZWFzZSBkZWZpbmUgYSBkZWZhdWx0IG9yIHN0YXRlIHRoZSBidW5kbGUgdG8gYmUgdXNlZCB3aXRoIGEgQ0xJIGZsYWdgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3M6IGFyZ3MubWFwLFxuICAgICAgICAgICAgICAgICAgICBidW5kbGUsXG4gICAgICAgICAgICAgICAgICAgIGFsbFByb2plY3RzLFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFByb2plY3RzLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBwLFxuICAgICAgICAgICAgICAgICAgICBpbnB1dDogW10sXG4gICAgICAgICAgICAgICAgICAgIGdldCBvdXRwdXQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShtbGZzLndyaXR0ZW5GaWxlcyk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZpbGVTeXN0ZW06IGZzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGNvbXBpbGVNb2RlbCA9IGF3YWl0IHBsdWdpbl9waGFzZV8xLnBsdWdpbkJhc2VkUGhhc2UoJ2luaXQnLCBjb21waWxlTW9kZWwsIGNvbnRleHQpO1xuICAgICAgICBjb21waWxlTW9kZWwgPSBhd2FpdCBpbnB1dF8xLmlucHV0UGhhc2UoY29tcGlsZU1vZGVsLCBjb250ZXh0KTtcbiAgICAgICAgY29tcGlsZU1vZGVsID0gYXdhaXQgcGx1Z2luX3BoYXNlXzEucGx1Z2luQmFzZWRQaGFzZSgnbGluaycsIGNvbXBpbGVNb2RlbCwgY29udGV4dCk7XG4gICAgICAgIHRoaXMuc29ydEJ5RGVwZW5kZW5jaWVzKGNvbXBpbGVNb2RlbCwgc2VsZWN0ZWRQcm9qZWN0cyk7XG4gICAgICAgIGNvbXBpbGVNb2RlbCA9IGF3YWl0IHBsdWdpbl9waGFzZV8xLnBsdWdpbkJhc2VkUGhhc2UoJ3ByZVByb2Nlc3MnLCBjb21waWxlTW9kZWwsIGNvbnRleHQpO1xuICAgICAgICBjb21waWxlTW9kZWwgPSBhd2FpdCBwbHVnaW5fcGhhc2VfMS5wbHVnaW5CYXNlZENoYWluZWRQaGFzZShbJ2NvbXBpbGUnLCAncG9zdFByb2Nlc3MnLCB7IG5hbWU6ICdlbWl0JywgZGVmYXVsdFBsdWdpbnM6IFsnb3V0cHV0J10gfV0sIGNvbXBpbGVNb2RlbCwgY29udGV4dCk7XG4gICAgfVxuICAgIHNvcnRCeURlcGVuZGVuY2llcyhjb21waWxlTW9kZWwsIHNlbGVjdGVkUHJvamVjdHMpIHtcbiAgICAgICAgY29uc3Qgb3JkZXIgPSBbXTtcbiAgICAgICAgd2hpbGUgKGNvbXBpbGVNb2RlbC5wcm9qZWN0c0J1aWxkRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgY2lyY2xlID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBjb21waWxlTW9kZWwucHJvamVjdHNCdWlsZERhdGEubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNBbGwoY29tcGlsZU1vZGVsLnByb2plY3RzQnVpbGREYXRhW2ldLnByb2plY3QucHJvamVjdERlcGVuZGVuY2llcywgc2VsZWN0ZWRQcm9qZWN0cywgb3JkZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLnB1c2goY29tcGlsZU1vZGVsLnByb2plY3RzQnVpbGREYXRhW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgY29tcGlsZU1vZGVsLnByb2plY3RzQnVpbGREYXRhLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgY2lyY2xlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNpcmNsZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2lyY3VsYXIgZGVwZW5kZW5jeSBpbiBwcm9qZWN0IGRlcGVuZGVuY2llcycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbXBpbGVNb2RlbC5wcm9qZWN0c0J1aWxkRGF0YSA9IG9yZGVyO1xuICAgIH1cbiAgICBoYXNBbGwocHJvamVjdERlcGVuZGVuY2llcywgc2VsZWN0ZWRQcm9qZWN0cywgb3JkZXIpIHtcbiAgICAgICAgZm9yIChjb25zdCBwIG9mIHByb2plY3REZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgICAgIGlmICghc2VsZWN0ZWRQcm9qZWN0cy5pbmNsdWRlcyhwKSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGhhcyA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yIChjb25zdCBvIG9mIG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKG8ucHJvamVjdCA9PT0gcCkge1xuICAgICAgICAgICAgICAgICAgICBoYXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWhhcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG5leHBvcnRzLkNvbXBpbGVyID0gQ29tcGlsZXI7XG5leHBvcnRzLmNvbXBpbGVyID0gbmV3IENvbXBpbGVyKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lZMjl0Y0dsc1pYSXVhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lKamIyMXdhV3hsY2k1cWN5SmRMQ0p1WVcxbGN5STZXMTBzSW0xaGNIQnBibWR6SWpvaU96dEJRVUZCTERaRFFVRXlSanRCUVVNelJpd3dRMEZCTkVNN1FVRkROVU1zZDBSQlFXdEdPMEZCUTJ4R0xIRkVRVUUwUXp0QlFVTTFReXhOUVVGaExGRkJRVkU3U1VGRGFrSXNTMEZCU3l4RFFVRkRMRTlCUVU4c1EwRkJReXhuUWtGQlowSXNSVUZCUlN4WFFVRlhMRVZCUVVVc1QwRkJUeXhGUVVGRkxFbEJRVWs3VVVGRGRFUXNTVUZCU1N4WlFVRlpMRWRCUVVjN1dVRkRaaXhwUWtGQmFVSXNSVUZCUlN4blFrRkJaMElzUTBGQlF5eEhRVUZITEVOQlFVTXNRMEZCUXl4RFFVRkRMRVZCUVVVc1JVRkJSVHRuUWtGRE1VTXNUVUZCVFN4SlFVRkpMRWRCUVVjc1NVRkJTU3h6UTBGQmQwSXNRMEZCUXl4SlFVRkpMRGhDUVVGblFpeEZRVUZGTEVOQlFVTXNRMEZCUXp0blFrRkRiRVVzVFVGQlRTeEZRVUZGTEVkQlFVY3NTVUZCU1N3NFFrRkJaMElzUTBGQlF5eFBRVUZQTEVOQlFVTXNWVUZCVlN4RlFVRkZMRWxCUVVrc1EwRkJReXhEUVVGRE8yZENRVU14UkN4TlFVRk5MRTFCUVUwc1IwRkJSeXd5UWtGQlV5eERRVUZETEVOQlFVTXNRMEZCUXl4alFVRmpMRVZCUVVVc1NVRkJTU3hEUVVGRExFZEJRVWNzUTBGQlF5eERRVUZETzJkQ1FVTnlSQ3hKUVVGSkxFTkJRVU1zVFVGQlRTeEZRVUZGTzI5Q1FVTlVMRTFCUVUwc1NVRkJTU3hMUVVGTExFTkJRVU1zTmtOQlFUWkRMRU5CUVVNc2VVVkJRWGxGTEVOQlFVTXNRMEZCUXp0cFFrRkROVWs3WjBKQlEwUXNUMEZCVHp0dlFrRkRTQ3hMUVVGTExFVkJRVVVzU1VGQlNTeERRVUZETEVkQlFVYzdiMEpCUTJZc1RVRkJUVHR2UWtGRFRpeFhRVUZYTzI5Q1FVTllMR2RDUVVGblFqdHZRa0ZEYUVJc1QwRkJUeXhGUVVGRkxFTkJRVU03YjBKQlExWXNTMEZCU3l4RlFVRkZMRVZCUVVVN2IwSkJRMVFzU1VGQlNTeE5RVUZOTzNkQ1FVTk9MRTlCUVU4c1MwRkJTeXhEUVVGRExFbEJRVWtzUTBGQlF5eEpRVUZKTEVOQlFVTXNXVUZCV1N4RFFVRkRMRU5CUVVNN2IwSkJRM3BETEVOQlFVTTdiMEpCUTBRc1ZVRkJWU3hGUVVGRkxFVkJRVVU3YVVKQlEycENMRU5CUVVNN1dVRkRUaXhEUVVGRExFTkJRVU03VTBGRFRDeERRVUZETzFGQlEwWXNXVUZCV1N4SFFVRkhMRTFCUVUwc0swSkJRV2RDTEVOQlFVTXNUVUZCVFN4RlFVRkZMRmxCUVZrc1JVRkJSU3hQUVVGUExFTkJRVU1zUTBGQlF6dFJRVU55UlN4WlFVRlpMRWRCUVVjc1RVRkJUU3hyUWtGQlZTeERRVUZETEZsQlFWa3NSVUZCUlN4UFFVRlBMRU5CUVVNc1EwRkJRenRSUVVOMlJDeFpRVUZaTEVkQlFVY3NUVUZCVFN3clFrRkJaMElzUTBGQlF5eE5RVUZOTEVWQlFVVXNXVUZCV1N4RlFVRkZMRTlCUVU4c1EwRkJReXhEUVVGRE8xRkJRM0pGTEVsQlFVa3NRMEZCUXl4clFrRkJhMElzUTBGQlF5eFpRVUZaTEVWQlFVVXNaMEpCUVdkQ0xFTkJRVU1zUTBGQlF6dFJRVU40UkN4WlFVRlpMRWRCUVVjc1RVRkJUU3dyUWtGQlowSXNRMEZCUXl4WlFVRlpMRVZCUVVVc1dVRkJXU3hGUVVGRkxFOUJRVThzUTBGQlF5eERRVUZETzFGQlF6TkZMRmxCUVZrc1IwRkJSeXhOUVVGTkxITkRRVUYxUWl4RFFVRkRMRU5CUVVNc1UwRkJVeXhGUVVGRkxHRkJRV0VzUlVGQlJTeEZRVUZGTEVsQlFVa3NSVUZCUlN4TlFVRk5MRVZCUVVVc1kwRkJZeXhGUVVGRkxFTkJRVU1zVVVGQlVTeERRVUZETEVWQlFVVXNRMEZCUXl4RlFVRkZMRmxCUVZrc1JVRkJSU3hQUVVGUExFTkJRVU1zUTBGQlF6dEpRVU5zU2l4RFFVRkRPMGxCUTBRc2EwSkJRV3RDTEVOQlFVTXNXVUZCV1N4RlFVRkZMR2RDUVVGblFqdFJRVU0zUXl4TlFVRk5MRXRCUVVzc1IwRkJSeXhGUVVGRkxFTkJRVU03VVVGRGFrSXNUMEZCVHl4WlFVRlpMRU5CUVVNc2FVSkJRV2xDTEVOQlFVTXNUVUZCVFN4SFFVRkhMRU5CUVVNc1JVRkJSVHRaUVVNNVF5eEpRVUZKTEUxQlFVMHNSMEZCUnl4SlFVRkpMRU5CUVVNN1dVRkRiRUlzUzBGQlN5eEpRVUZKTEVOQlFVTXNSMEZCUnl4WlFVRlpMRU5CUVVNc2FVSkJRV2xDTEVOQlFVTXNUVUZCVFN4SFFVRkhMRU5CUVVNc1JVRkJSU3hEUVVGRExFbEJRVWtzUTBGQlF5eEZRVUZGTEVOQlFVTXNSVUZCUlN4RlFVRkZPMmRDUVVOcVJTeEpRVUZKTEVsQlFVa3NRMEZCUXl4TlFVRk5MRU5CUVVNc1dVRkJXU3hEUVVGRExHbENRVUZwUWl4RFFVRkRMRU5CUVVNc1EwRkJReXhEUVVGRExFOUJRVThzUTBGQlF5eHRRa0ZCYlVJc1JVRkJSU3huUWtGQlowSXNSVUZCUlN4TFFVRkxMRU5CUVVNc1JVRkJSVHR2UWtGRGNrY3NTMEZCU3l4RFFVRkRMRWxCUVVrc1EwRkJReXhaUVVGWkxFTkJRVU1zYVVKQlFXbENMRU5CUVVNc1EwRkJReXhEUVVGRExFTkJRVU1zUTBGQlF6dHZRa0ZET1VNc1dVRkJXU3hEUVVGRExHbENRVUZwUWl4RFFVRkRMRTFCUVUwc1EwRkJReXhEUVVGRExFVkJRVVVzUTBGQlF5eERRVUZETEVOQlFVTTdiMEpCUXpWRExFMUJRVTBzUjBGQlJ5eExRVUZMTEVOQlFVTTdhVUpCUTJ4Q08yRkJRMG83V1VGRFJDeEpRVUZKTEUxQlFVMHNSVUZCUlR0blFrRkRVaXhOUVVGTkxFbEJRVWtzUzBGQlN5eERRVUZETERaRFFVRTJReXhEUVVGRExFTkJRVU03WVVGRGJFVTdVMEZEU2p0UlFVTkVMRmxCUVZrc1EwRkJReXhwUWtGQmFVSXNSMEZCUnl4TFFVRkxMRU5CUVVNN1NVRkRNME1zUTBGQlF6dEpRVU5FTEUxQlFVMHNRMEZCUXl4dFFrRkJiVUlzUlVGQlJTeG5Ra0ZCWjBJc1JVRkJSU3hMUVVGTE8xRkJReTlETEV0QlFVc3NUVUZCVFN4RFFVRkRMRWxCUVVrc2JVSkJRVzFDTEVWQlFVVTdXVUZEYWtNc1NVRkJTU3hEUVVGRExHZENRVUZuUWl4RFFVRkRMRkZCUVZFc1EwRkJReXhEUVVGRExFTkJRVU1zUlVGQlJUdG5Ra0ZETDBJc1UwRkJVenRoUVVOYU8xbEJRMFFzU1VGQlNTeEhRVUZITEVkQlFVY3NTMEZCU3l4RFFVRkRPMWxCUTJoQ0xFdEJRVXNzVFVGQlRTeERRVUZETEVsQlFVa3NTMEZCU3l4RlFVRkZPMmRDUVVOdVFpeEpRVUZKTEVOQlFVTXNRMEZCUXl4UFFVRlBMRXRCUVVzc1EwRkJReXhGUVVGRk8yOUNRVU5xUWl4SFFVRkhMRWRCUVVjc1NVRkJTU3hEUVVGRE8yOUNRVU5ZTEUxQlFVMDdhVUpCUTFRN1lVRkRTanRaUVVORUxFbEJRVWtzUTBGQlF5eEhRVUZITEVWQlFVVTdaMEpCUTA0c1QwRkJUeXhMUVVGTExFTkJRVU03WVVGRGFFSTdVMEZEU2p0UlFVTkVMRTlCUVU4c1NVRkJTU3hEUVVGRE8wbEJRMmhDTEVOQlFVTTdRMEZEU2p0QlFXeEZSQ3cwUWtGclJVTTdRVUZEV1N4UlFVRkJMRkZCUVZFc1IwRkJSeXhKUVVGSkxGRkJRVkVzUlVGQlJTeERRVUZESW4wPSJdfQ==